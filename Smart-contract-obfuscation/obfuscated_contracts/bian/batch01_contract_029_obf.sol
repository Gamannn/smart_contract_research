pragma solidity ^0.4.11;contract Oxd004353e0bbf6987335667b73a14226944cfef21 { function safeMul(uint Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a, uint Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9) internal returns (uint) { uint Ox835561129e09a12ae746c1be7e40e27c0f1611e4 = Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a * Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9; assert(Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a == 0 || Ox835561129e09a12ae746c1be7e40e27c0f1611e4 / Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a == Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9); return Ox835561129e09a12ae746c1be7e40e27c0f1611e4; } function safeSub(uint Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a, uint Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9) internal returns (uint) { assert(Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9 <= Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a); return Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a - Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9; } function safeAdd(uint Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a, uint Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9) internal returns (uint) { uint Ox835561129e09a12ae746c1be7e40e27c0f1611e4 = Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a + Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9; assert(Ox835561129e09a12ae746c1be7e40e27c0f1611e4>=Ox3e722b66e550fd55c2f091972b87dc8b70eaef6a && Ox835561129e09a12ae746c1be7e40e27c0f1611e4>=Oxf30b67c7e4e7b2483d59cba8d9fdc1c1c23586a9); return Ox835561129e09a12ae746c1be7e40e27c0f1611e4; } function assert(bool assertion) internal { if (!assertion) throw; }}contract Token { function Oxe9d431ed9913465c5775fc6fcd474ece661af4b3() constant returns (uint256 supply) {} function Ox369ab2f4f8ef3056eb54df8059256acf0e132853(address Oxe4f6b42b759b79e534f72f3203fac9d0c7dc4da0) constant returns (uint256 balance) {} function Oxd17225a150917e710722963924e46d940a2dff62(address Oxe467afcbefb8a2820517b01410d74384d888ced5, uint256 Ox84bedcbb364203616579c2c09e78fe20adfec3c9) returns (bool success) {} function Oxf6288f81bb774c130924484e8f22f24bdd00db9f(address Ox891092677155cdabca909501d871ae8589877674, address Oxe467afcbefb8a2820517b01410d74384d888ced5, uint256 Ox84bedcbb364203616579c2c09e78fe20adfec3c9) returns (bool success) {} function Ox170557a38f49d34e3d8515fae5067ca19a7ccd0c(address Ox33ea96e82169748f42f84ee7111ce3f8d33c1b18, uint256 Ox84bedcbb364203616579c2c09e78fe20adfec3c9) returns (bool success) {} function Ox777ffec845b01aa58212c46839ec26e96bc79b03(address Oxe4f6b42b759b79e534f72f3203fac9d0c7dc4da0, address Ox33ea96e82169748f42f84ee7111ce3f8d33c1b18) constant returns (uint256 remaining) {} event Transfer(address indexed Ox891092677155cdabca909501d871ae8589877674, address indexed Oxe467afcbefb8a2820517b01410d74384d888ced5, uint256 Ox84bedcbb364203616579c2c09e78fe20adfec3c9); event Approval(address indexed Oxe4f6b42b759b79e534f72f3203fac9d0c7dc4da0, address indexed Ox33ea96e82169748f42f84ee7111ce3f8d33c1b18, uint256 Ox84bedcbb364203616579c2c09e78fe20adfec3c9); string public Oxf67ba5b704813bd58b223a301e846c28d50e10cf;}contract Ox64b6b48fa70e4b30d2828696c78103c940f2ea5e is Token { function Oxd17225a150917e710722963924e46d940a2dff62(address Oxe467afcbefb8a2820517b01410d74384d888ced5, uint256 Ox84bedcbb364203616579c2c09e78fe20adfec3c9) returns (bool success) { if (Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[msg.sender] >= Ox84bedcbb364203616579c2c09e78fe20adfec3c9 && Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Oxe467afcbefb8a2820517b01410d74384d888ced5] + Ox84bedcbb364203616579c2c09e78fe20adfec3c9 > Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Oxe467afcbefb8a2820517b01410d74384d888ced5]) { Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[msg.sender] -= Ox84bedcbb364203616579c2c09e78fe20adfec3c9; Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Oxe467afcbefb8a2820517b01410d74384d888ced5] += Ox84bedcbb364203616579c2c09e78fe20adfec3c9; Transfer(msg.sender, Oxe467afcbefb8a2820517b01410d74384d888ced5, Ox84bedcbb364203616579c2c09e78fe20adfec3c9); return true; } else { return false; } } function Oxf6288f81bb774c130924484e8f22f24bdd00db9f(address Ox891092677155cdabca909501d871ae8589877674, address Oxe467afcbefb8a2820517b01410d74384d888ced5, uint256 Ox84bedcbb364203616579c2c09e78fe20adfec3c9) returns (bool success) { if (Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Ox891092677155cdabca909501d871ae8589877674] >= Ox84bedcbb364203616579c2c09e78fe20adfec3c9 && Oxc4a02804d90e554ad0e877d1c42f541af54b450b[Ox891092677155cdabca909501d871ae8589877674][msg.sender] >= Ox84bedcbb364203616579c2c09e78fe20adfec3c9 && Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Oxe467afcbefb8a2820517b01410d74384d888ced5] + Ox84bedcbb364203616579c2c09e78fe20adfec3c9 > Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Oxe467afcbefb8a2820517b01410d74384d888ced5]) { Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Oxe467afcbefb8a2820517b01410d74384d888ced5] += Ox84bedcbb364203616579c2c09e78fe20adfec3c9; Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Ox891092677155cdabca909501d871ae8589877674] -= Ox84bedcbb364203616579c2c09e78fe20adfec3c9; Oxc4a02804d90e554ad0e877d1c42f541af54b450b[Ox891092677155cdabca909501d871ae8589877674][msg.sender] -= Ox84bedcbb364203616579c2c09e78fe20adfec3c9; Transfer(Ox891092677155cdabca909501d871ae8589877674, Oxe467afcbefb8a2820517b01410d74384d888ced5, Ox84bedcbb364203616579c2c09e78fe20adfec3c9); return true; } else { return false; } } function Ox369ab2f4f8ef3056eb54df8059256acf0e132853(address Oxe4f6b42b759b79e534f72f3203fac9d0c7dc4da0) constant returns (uint256 balance) { return Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[Oxe4f6b42b759b79e534f72f3203fac9d0c7dc4da0]; } function Ox170557a38f49d34e3d8515fae5067ca19a7ccd0c(address Ox33ea96e82169748f42f84ee7111ce3f8d33c1b18, uint256 Ox84bedcbb364203616579c2c09e78fe20adfec3c9) returns (bool success) { Oxc4a02804d90e554ad0e877d1c42f541af54b450b[msg.sender][Ox33ea96e82169748f42f84ee7111ce3f8d33c1b18] = Ox84bedcbb364203616579c2c09e78fe20adfec3c9; Approval(msg.sender, Ox33ea96e82169748f42f84ee7111ce3f8d33c1b18, Ox84bedcbb364203616579c2c09e78fe20adfec3c9); return true; } function Ox777ffec845b01aa58212c46839ec26e96bc79b03(address Oxe4f6b42b759b79e534f72f3203fac9d0c7dc4da0, address Ox33ea96e82169748f42f84ee7111ce3f8d33c1b18) constant returns (uint256 remaining) { return Oxc4a02804d90e554ad0e877d1c42f541af54b450b[Oxe4f6b42b759b79e534f72f3203fac9d0c7dc4da0][Ox33ea96e82169748f42f84ee7111ce3f8d33c1b18]; } mapping(address => uint256) Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c; mapping (address => mapping (address => uint256)) Oxc4a02804d90e554ad0e877d1c42f541af54b450b; }contract ReserveToken is Ox64b6b48fa70e4b30d2828696c78103c940f2ea5e, Oxd004353e0bbf6987335667b73a14226944cfef21 { function ReserveToken() { s2c.minter = msg.sender; } function create(address account, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) { if (msg.sender != s2c.minter) throw; Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[account] = safeAdd(Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[account], Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); s2c.Oxe9d431ed9913465c5775fc6fcd474ece661af4b3 = safeAdd(s2c.Oxe9d431ed9913465c5775fc6fcd474ece661af4b3, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); } function destroy(address account, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) { if (msg.sender != s2c.minter) throw; if (Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[account] < Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) throw; Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[account] = safeSub(Ox9fc7685c4dbbfc3a485d25dcd1dd723f166b3f4c[account], Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); s2c.Oxe9d431ed9913465c5775fc6fcd474ece661af4b3 = safeSub(s2c.Oxe9d431ed9913465c5775fc6fcd474ece661af4b3, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); }}contract AccountLevels { function accountLevel(address user) constant returns(uint) {}}contract AccountLevelsTest is AccountLevels { mapping (address => uint) public accountLevels; function setAccountLevel(address user, uint level) { accountLevels[user] = level; } function accountLevel(address user) constant returns(uint) { return accountLevels[user]; }}contract Bitcratic is Oxd004353e0bbf6987335667b73a14226944cfef21 { mapping (address => mapping (address => uint)) public tokens; mapping (address => mapping (bytes32 => bool)) public orders; mapping (address => mapping (bytes32 => uint)) public orderFills; event Order(address tokenGet, uint amountGet, address tokenGive, uint amountGive, uint expires, uint nonce, address user); event Cancel(address tokenGet, uint amountGet, address tokenGive, uint amountGive, uint expires, uint nonce, address user, uint8 v, bytes32 r, bytes32 s); event Trade(address tokenGet, uint amountGet, address tokenGive, uint amountGive, address get, address give); event Deposit(address token, address user, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, uint balance); event Withdraw(address token, address user, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, uint balance); function Bitcratic(address admin_, address feeAccount_, address accountLevelsAddr_, uint feeMake_, uint feeTake_, uint feeRebate_) { s2c.admin = admin_; s2c.feeAccount = feeAccount_; s2c.accountLevelsAddr = accountLevelsAddr_; s2c.feeMake = feeMake_; s2c.feeTake = feeTake_; s2c.feeRebate = feeRebate_; } function() { throw; } function changeAdmin(address admin_) { if (msg.sender != s2c.admin) throw; s2c.admin = admin_; } function changeAccountLevelsAddr(address accountLevelsAddr_) { if (msg.sender != s2c.admin) throw; s2c.accountLevelsAddr = accountLevelsAddr_; } function changeFeeAccount(address feeAccount_) { if (msg.sender != s2c.admin) throw; s2c.feeAccount = feeAccount_; } function changeFeeMake(uint feeMake_) { if (msg.sender != s2c.admin) throw; if (feeMake_ > s2c.feeMake) throw; s2c.feeMake = feeMake_; } function changeFeeTake(uint feeTake_) { if (msg.sender != s2c.admin) throw; if (feeTake_ > s2c.feeTake || feeTake_ < s2c.feeRebate) throw; s2c.feeTake = feeTake_; } function changeFeeRebate(uint feeRebate_) { if (msg.sender != s2c.admin) throw; if (feeRebate_ < s2c.feeRebate || feeRebate_ > s2c.feeTake) throw; s2c.feeRebate = feeRebate_; } function deposit() payable { tokens[0][msg.sender] = safeAdd(tokens[0][msg.sender], msg.Ox0f0fedeb70a3abb0a74a78617f9030c1ff19aae4); Deposit(0, msg.sender, msg.Ox0f0fedeb70a3abb0a74a78617f9030c1ff19aae4, tokens[0][msg.sender]); } function withdraw(uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) { if (tokens[0][msg.sender] < Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) throw; tokens[0][msg.sender] = safeSub(tokens[0][msg.sender], Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); if (!msg.sender.call.Ox0f0fedeb70a3abb0a74a78617f9030c1ff19aae4(Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb)()) throw; Withdraw(0, msg.sender, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, tokens[0][msg.sender]); } function depositToken(address token, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) { if (token==0) throw; if (!Token(token).Oxf6288f81bb774c130924484e8f22f24bdd00db9f(msg.sender, this, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb)) throw; tokens[token][msg.sender] = safeAdd(tokens[token][msg.sender], Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); Deposit(token, msg.sender, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, tokens[token][msg.sender]); } function withdrawToken(address token, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) { if (token==0) throw; if (tokens[token][msg.sender] < Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) throw; tokens[token][msg.sender] = safeSub(tokens[token][msg.sender], Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); if (!Token(token).Oxd17225a150917e710722963924e46d940a2dff62(msg.sender, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb)) throw; Withdraw(token, msg.sender, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, tokens[token][msg.sender]); } function Ox369ab2f4f8ef3056eb54df8059256acf0e132853(address token, address user) constant returns (uint) { return tokens[token][user]; } function order(address tokenGet, uint amountGet, address tokenGive, uint amountGive, uint expires, uint nonce) { bytes32 hash = sha256(this, tokenGet, amountGet, tokenGive, amountGive, expires, nonce); orders[msg.sender][hash] = true; Order(tokenGet, amountGet, tokenGive, amountGive, expires, nonce, msg.sender); } function trade(address tokenGet, uint amountGet, address tokenGive, uint amountGive, uint expires, uint nonce, address user, uint8 v, bytes32 r, bytes32 s, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) { bytes32 hash = sha256(this, tokenGet, amountGet, tokenGive, amountGive, expires, nonce); if (!( (orders[user][hash] || ecrecover(sha3("\x19Ethereum Signed Message:\n32", hash),v,r,s) == user) && block.number <= expires && safeAdd(orderFills[user][hash], Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) <= amountGet )) throw; tradeBalances(tokenGet, amountGet, tokenGive, amountGive, user, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); orderFills[user][hash] = safeAdd(orderFills[user][hash], Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb); Trade(tokenGet, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, tokenGive, amountGive * Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb / amountGet, user, msg.sender); } function tradeBalances(address tokenGet, uint amountGet, address tokenGive, uint amountGive, address user, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) private { uint feeMakeXfer = safeMul(Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, s2c.feeMake) / (1 ether); uint feeTakeXfer = safeMul(Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, s2c.feeTake) / (1 ether); uint feeRebateXfer = 0; if (s2c.accountLevelsAddr != 0x0) { uint accountLevel = AccountLevels(s2c.accountLevelsAddr).accountLevel(user); if (accountLevel==1) feeRebateXfer = safeMul(Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, s2c.feeRebate) / (1 ether); if (accountLevel==2) feeRebateXfer = feeTakeXfer; } tokens[tokenGet][msg.sender] = safeSub(tokens[tokenGet][msg.sender], safeAdd(Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, feeTakeXfer)); tokens[tokenGet][user] = safeAdd(tokens[tokenGet][user], safeSub(safeAdd(Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, feeRebateXfer), feeMakeXfer)); tokens[tokenGet][s2c.feeAccount] = safeAdd(tokens[tokenGet][s2c.feeAccount], safeSub(safeAdd(feeMakeXfer, feeTakeXfer), feeRebateXfer)); tokens[tokenGive][user] = safeSub(tokens[tokenGive][user], safeMul(amountGive, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) / amountGet); tokens[tokenGive][msg.sender] = safeAdd(tokens[tokenGive][msg.sender], safeMul(amountGive, Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb) / amountGet); } function testTrade(address tokenGet, uint amountGet, address tokenGive, uint amountGive, uint expires, uint nonce, address user, uint8 v, bytes32 r, bytes32 s, uint Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb, address sender) constant returns(bool) { if (!( tokens[tokenGet][sender] >= Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb && availableVolume(tokenGet, amountGet, tokenGive, amountGive, expires, nonce, user, v, r, s) >= Ox8163e0a9002f7c2b831457dbab24ad1cc219d1eb )) return false; return true; } function availableVolume(address tokenGet, uint amountGet, address tokenGive, uint amountGive, uint expires, uint nonce, address user, uint8 v, bytes32 r, bytes32 s) constant returns(uint) { bytes32 hash = sha256(this, tokenGet, amountGet, tokenGive, amountGive, expires, nonce); if (!( (orders[user][hash] || ecrecover(sha3("\x19Ethereum Signed Message:\n32", hash),v,r,s) == user) && block.number <= expires )) return 0; uint available1 = safeSub(amountGet, orderFills[user][hash]); uint available2 = safeMul(tokens[tokenGive][user], amountGet) / amountGive; if (available1<available2) return available1; return available2; } function amountFilled(address tokenGet, uint amountGet, address tokenGive, uint amountGive, uint expires, uint nonce, address user, uint8 v, bytes32 r, bytes32 s) constant returns(uint) { bytes32 hash = sha256(this, tokenGet, amountGet, tokenGive, amountGive, expires, nonce); return orderFills[user][hash]; } function cancelOrder(address tokenGet, uint amountGet, address tokenGive, uint amountGive, uint expires, uint nonce, uint8 v, bytes32 r, bytes32 s) { bytes32 hash = sha256(this, tokenGet, amountGet, tokenGive, amountGive, expires, nonce); if (!(orders[msg.sender][hash] || ecrecover(sha3("\x19Ethereum Signed Message:\n32", hash),v,r,s) == msg.sender)) throw; orderFills[msg.sender][hash] = amountGet; Cancel(tokenGet, amountGet, tokenGive, amountGive, expires, nonce, msg.sender, v, r, s); }struct scalar2Vector {uint256 feeRebate;uint256 feeTake;uint256 feeMake;address accountLevelsAddr;address feeAccount;address admin;address minter;uint256 Oxe9d431ed9913465c5775fc6fcd474ece661af4b3;uint256 Oxce87386a5d7dfdb6dd67cc1273861c0af639a80c;}scalar2Vector s2c = scalar2Vector(0, 0, 0, address(0), address(0), address(0), address(0), 0, 0);}