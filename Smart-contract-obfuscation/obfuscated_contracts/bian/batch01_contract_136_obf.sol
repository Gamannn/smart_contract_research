pragma solidity ^0.4.21;interface VaultInterface { event Deposited(address indexed user, address token, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b); event Withdrawn(address indexed user, address token, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b); event Approved(address indexed user, address indexed spender); event Unapproved(address indexed user, address indexed spender); event AddedSpender(address indexed spender); event RemovedSpender(address indexed spender); function deposit(address token, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b) external payable; function Ox59988bffd52484b2f5021f84b1292e570cc7a0be(address token, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b) external; function transfer(address token, address from, address to, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b) external; function approve(address spender) external; function unapprove(address spender) external; function isApproved(address user, address spender) external view returns (bool); function addSpender(address spender) external; function removeSpender(address spender) external; function latestSpender() external view returns (address); function isSpender(address spender) external view returns (bool); function tokenFallback(address from, uint value, bytes data) public; function balanceOf(address token, address user) public view returns (uint);}interface ERC820 { function setInterfaceImplementer(address addr, bytes32 iHash, address implementer) public;}library Ox9a5e001e9f88ff24128b99ee47ccf1c7bff406da { function mul(uint Ox6cb75472562c91689cd2fde33baa4cb629ed88cb, uint Oxe1810366233255a4b8dac1774e3c4b57cd43396f) internal pure returns (uint) { uint Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e = Ox6cb75472562c91689cd2fde33baa4cb629ed88cb * Oxe1810366233255a4b8dac1774e3c4b57cd43396f; assert(Ox6cb75472562c91689cd2fde33baa4cb629ed88cb == 0 || Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e / Ox6cb75472562c91689cd2fde33baa4cb629ed88cb == Oxe1810366233255a4b8dac1774e3c4b57cd43396f); return Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e; } function div(uint Ox6cb75472562c91689cd2fde33baa4cb629ed88cb, uint Oxe1810366233255a4b8dac1774e3c4b57cd43396f) internal pure returns (uint) { assert(Oxe1810366233255a4b8dac1774e3c4b57cd43396f > 0); uint Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e = Ox6cb75472562c91689cd2fde33baa4cb629ed88cb / Oxe1810366233255a4b8dac1774e3c4b57cd43396f; assert(Ox6cb75472562c91689cd2fde33baa4cb629ed88cb == Oxe1810366233255a4b8dac1774e3c4b57cd43396f * Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e + Ox6cb75472562c91689cd2fde33baa4cb629ed88cb % Oxe1810366233255a4b8dac1774e3c4b57cd43396f); return Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e; } function sub(uint Ox6cb75472562c91689cd2fde33baa4cb629ed88cb, uint Oxe1810366233255a4b8dac1774e3c4b57cd43396f) internal pure returns (uint) { assert(Oxe1810366233255a4b8dac1774e3c4b57cd43396f <= Ox6cb75472562c91689cd2fde33baa4cb629ed88cb); return Ox6cb75472562c91689cd2fde33baa4cb629ed88cb - Oxe1810366233255a4b8dac1774e3c4b57cd43396f; } function add(uint Ox6cb75472562c91689cd2fde33baa4cb629ed88cb, uint Oxe1810366233255a4b8dac1774e3c4b57cd43396f) internal pure returns (uint) { uint Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e = Ox6cb75472562c91689cd2fde33baa4cb629ed88cb + Oxe1810366233255a4b8dac1774e3c4b57cd43396f; assert(Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e >= Ox6cb75472562c91689cd2fde33baa4cb629ed88cb); return Ox2f6a8bca37083d5c9af752bbdf723ddc93c0132e; } function Oxa1d31dfb854e0c8632cbec181b8ae00e48552056(uint64 Ox6cb75472562c91689cd2fde33baa4cb629ed88cb, uint64 Oxe1810366233255a4b8dac1774e3c4b57cd43396f) internal pure returns (uint64) { return Ox6cb75472562c91689cd2fde33baa4cb629ed88cb >= Oxe1810366233255a4b8dac1774e3c4b57cd43396f ? Ox6cb75472562c91689cd2fde33baa4cb629ed88cb : Oxe1810366233255a4b8dac1774e3c4b57cd43396f; } function Ox4f7f316a29a699325f46d3259eb01cec729a9be9(uint64 Ox6cb75472562c91689cd2fde33baa4cb629ed88cb, uint64 Oxe1810366233255a4b8dac1774e3c4b57cd43396f) internal pure returns (uint64) { return Ox6cb75472562c91689cd2fde33baa4cb629ed88cb < Oxe1810366233255a4b8dac1774e3c4b57cd43396f ? Ox6cb75472562c91689cd2fde33baa4cb629ed88cb : Oxe1810366233255a4b8dac1774e3c4b57cd43396f; } function Ox724312e6713d2f85ec1d8bad393a16e9e5e4d98c(uint Ox6cb75472562c91689cd2fde33baa4cb629ed88cb, uint Oxe1810366233255a4b8dac1774e3c4b57cd43396f) internal pure returns (uint) { return Ox6cb75472562c91689cd2fde33baa4cb629ed88cb >= Oxe1810366233255a4b8dac1774e3c4b57cd43396f ? Ox6cb75472562c91689cd2fde33baa4cb629ed88cb : Oxe1810366233255a4b8dac1774e3c4b57cd43396f; } function Ox791c049c90ab6789dbaf166c95e9dacafd1e73a7(uint Ox6cb75472562c91689cd2fde33baa4cb629ed88cb, uint Oxe1810366233255a4b8dac1774e3c4b57cd43396f) internal pure returns (uint) { return Ox6cb75472562c91689cd2fde33baa4cb629ed88cb < Oxe1810366233255a4b8dac1774e3c4b57cd43396f ? Ox6cb75472562c91689cd2fde33baa4cb629ed88cb : Oxe1810366233255a4b8dac1774e3c4b57cd43396f; }}contract Ox87c473424640dc7a793154071afcbee884a7fa85 { modifier Oxfd31f034a467bf388a3780747157d0050bab4435 { require(isOwner(msg.sender)); _; } function Ox87c473424640dc7a793154071afcbee884a7fa85() public { s2c.Ox94749599ffc48a096913e39308c4f432797cd75d = msg.sender; } function Ox22a30d1259ed13672499e6543b0650937d247a2e(address _newOwner) public Oxfd31f034a467bf388a3780747157d0050bab4435 { s2c.Ox94749599ffc48a096913e39308c4f432797cd75d = _newOwner; } function isOwner(address _address) public view returns (bool) { return s2c.Ox94749599ffc48a096913e39308c4f432797cd75d == _address; }}interface ERC20 { function totalSupply() public view returns (uint); function balanceOf(address Ox94749599ffc48a096913e39308c4f432797cd75d) public view returns (uint); function allowance(address Ox94749599ffc48a096913e39308c4f432797cd75d, address spender) public view returns (uint); function transfer(address to, uint value) public returns (bool); function transferFrom(address from, address to, uint value) public returns (bool); function approve(address spender, uint value) public returns (bool);}interface ERC777 { function name() public constant returns (string); function symbol() public constant returns (string); function totalSupply() public constant returns (uint256); function granularity() public constant returns (uint256); function balanceOf(address Ox94749599ffc48a096913e39308c4f432797cd75d) public constant returns (uint256); function send(address to, uint256 Oxc437aaf9cf6664059735712447e1e406c6b59e4b) public; function send(address to, uint256 Oxc437aaf9cf6664059735712447e1e406c6b59e4b, bytes userData) public; function authorizeOperator(address operator) public; function revokeOperator(address operator) public; function isOperatorFor(address operator, address tokenHolder) public constant returns (bool); function operatorSend(address from, address to, uint256 Oxc437aaf9cf6664059735712447e1e406c6b59e4b, bytes userData, bytes operatorData) public;}contract Vault is Ox87c473424640dc7a793154071afcbee884a7fa85, VaultInterface { using Ox9a5e001e9f88ff24128b99ee47ccf1c7bff406da for *; mapping (address => bool) public isERC777; mapping (address => mapping (address => bool)) private approved; mapping (address => mapping (address => uint)) private balances; mapping (address => uint) private accounted; mapping (address => bool) private spenders; modifier onlySpender { require(spenders[msg.sender]); _; } modifier onlyApproved(address user) { require(approved[user][msg.sender]); _; } function Vault(ERC820 registry) public { registry.setInterfaceImplementer(address(this), keccak256("ERC777TokensRecipient"), address(this)); } function deposit(address token, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b) external payable { require(token == s2c.ETH || msg.value == 0); uint value = Oxc437aaf9cf6664059735712447e1e406c6b59e4b; if (token == s2c.ETH) { value = msg.value; } else { require(ERC20(token).transferFrom(msg.sender, address(this), value)); } depositFor(msg.sender, token, value); } function Ox59988bffd52484b2f5021f84b1292e570cc7a0be(address token, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b) external { require(balanceOf(token, msg.sender) >= Oxc437aaf9cf6664059735712447e1e406c6b59e4b); balances[token][msg.sender] = balances[token][msg.sender].sub(Oxc437aaf9cf6664059735712447e1e406c6b59e4b); accounted[token] = accounted[token].sub(Oxc437aaf9cf6664059735712447e1e406c6b59e4b); withdrawTo(msg.sender, token, Oxc437aaf9cf6664059735712447e1e406c6b59e4b); emit Withdrawn(msg.sender, token, Oxc437aaf9cf6664059735712447e1e406c6b59e4b); } function approve(address spender) external { require(spenders[spender]); approved[msg.sender][spender] = true; emit Approved(msg.sender, spender); } function unapprove(address spender) external { approved[msg.sender][spender] = false; emit Unapproved(msg.sender, spender); } function addSpender(address spender) external Oxfd31f034a467bf388a3780747157d0050bab4435 { require(spender != 0x0); spenders[spender] = true; s2c.latest = spender; emit AddedSpender(spender); } function removeSpender(address spender) external Oxfd31f034a467bf388a3780747157d0050bab4435 { spenders[spender] = false; emit RemovedSpender(spender); } function transfer(address token, address from, address to, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b) external onlySpender onlyApproved(from) { require(Oxc437aaf9cf6664059735712447e1e406c6b59e4b > 0); balances[token][from] = balances[token][from].sub(Oxc437aaf9cf6664059735712447e1e406c6b59e4b); balances[token][to] = balances[token][to].add(Oxc437aaf9cf6664059735712447e1e406c6b59e4b); } function isApproved(address user, address spender) external view returns (bool) { return approved[user][spender]; } function isSpender(address spender) external view returns (bool) { return spenders[spender]; } function latestSpender() external view returns (address) { return s2c.latest; } function tokenFallback(address from, uint value, bytes) public { depositFor(from, msg.sender, value); } function tokensReceived(address, address from, address, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b, bytes, bytes) public { if (!isERC777[msg.sender]) { isERC777[msg.sender] = true; } depositFor(from, msg.sender, Oxc437aaf9cf6664059735712447e1e406c6b59e4b); } function setERC777(address token) public Oxfd31f034a467bf388a3780747157d0050bab4435 { isERC777[token] = true; } function unsetERC777(address token) public Oxfd31f034a467bf388a3780747157d0050bab4435 { isERC777[token] = false; } function withdrawOverflow(address token) public Oxfd31f034a467bf388a3780747157d0050bab4435 { withdrawTo(msg.sender, token, overflow(token)); } function balanceOf(address token, address user) public view returns (uint) { return balances[token][user]; } function overflow(address token) internal view returns (uint) { if (token == s2c.ETH) { return address(this).balance.sub(accounted[token]); } return ERC20(token).balanceOf(this).sub(accounted[token]); } function depositFor(address user, address token, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b) private { balances[token][user] = balances[token][user].add(Oxc437aaf9cf6664059735712447e1e406c6b59e4b); accounted[token] = accounted[token].add(Oxc437aaf9cf6664059735712447e1e406c6b59e4b); emit Deposited(user, token, Oxc437aaf9cf6664059735712447e1e406c6b59e4b); } function withdrawTo(address user, address token, uint Oxc437aaf9cf6664059735712447e1e406c6b59e4b) private { if (token == s2c.ETH) { user.transfer(Oxc437aaf9cf6664059735712447e1e406c6b59e4b); return; } if (isERC777[token]) { ERC777(token).send(user, Oxc437aaf9cf6664059735712447e1e406c6b59e4b); return; } require(ERC20(token).transfer(user, Oxc437aaf9cf6664059735712447e1e406c6b59e4b)); }struct scalar2Vector {address latest;address ETH;address Ox94749599ffc48a096913e39308c4f432797cd75d;}scalar2Vector s2c = scalar2Vector(address(0), 0x0, address(0));}