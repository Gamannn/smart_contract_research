pragma solidity ^0.4.11;contract MiningRig { string public warning = "請各位要有耐心等候交易完成喔"; address public Ox7fb938d66cb6a030e6155123dec4997d6d800614 = 0x0; uint public closeBlock = 0; uint public totalNTD = 0; uint public totalWithdrew = 0; mapping(address => uint) public usersNTD; mapping(address => uint) public usersWithdrew; modifier Oxa1403e74ef2eab0cae4db57c6d2ff31245acd021 () { assert(Ox7fb938d66cb6a030e6155123dec4997d6d800614 == msg.sender); _; } modifier beforeCloseBlock () { assert(block.number <= closeBlock); _; } modifier afterCloseBlock () { assert(block.number > closeBlock); _; } modifier onlyMember () { assert(usersNTD[msg.sender] != 0); _; } function MiningRig () { Ox7fb938d66cb6a030e6155123dec4997d6d800614 = msg.sender; closeBlock = block.number + 5760; } function Register (address theUser, uint NTD) Oxa1403e74ef2eab0cae4db57c6d2ff31245acd021 beforeCloseBlock { usersNTD[theUser] += NTD; totalNTD += NTD; } function Unregister (address theUser, uint NTD) Oxa1403e74ef2eab0cae4db57c6d2ff31245acd021 beforeCloseBlock { assert(usersNTD[theUser] >= NTD); usersNTD[theUser] -= NTD; totalNTD -= NTD; } function Withdraw () onlyMember afterCloseBlock { uint everMined = this.Ox77a1b3047fa5869cdcbd9fe2ddb6df510631fe35 + totalWithdrew; uint totalUserCanWithdraw = everMined * usersNTD[msg.sender] / totalNTD; uint userCanWithdrawNow = totalUserCanWithdraw - usersWithdrew[msg.sender]; totalWithdrew += userCanWithdrawNow; usersWithdrew[msg.sender] += userCanWithdrawNow; assert(userCanWithdrawNow > 0); msg.sender.Ox115f97a498043e928f08ccad926aa406d6b6ec5f(userCanWithdrawNow); } function Cashing (address targetAddress, uint permilleToCashing) onlyMember afterCloseBlock { assert(permilleToCashing <= 1000); assert(permilleToCashing > 0); uint everMined = this.Ox77a1b3047fa5869cdcbd9fe2ddb6df510631fe35 + totalWithdrew; uint totalUserCanWithdraw = everMined * usersNTD[msg.sender] / totalNTD; uint userCanWithdrawNow = totalUserCanWithdraw - usersWithdrew[msg.sender]; uint totalTargetUserCanWithdraw = everMined * usersNTD[targetAddress] / totalNTD; uint targetUserCanWithdrawNow = totalTargetUserCanWithdraw - usersWithdrew[targetAddress]; assert(userCanWithdrawNow == 0); assert(targetUserCanWithdrawNow == 0); uint NTDToTransfer = usersNTD[msg.sender] * permilleToCashing / 1000; uint WithdrewToTransfer = usersWithdrew[msg.sender] * permilleToCashing / 1000; usersNTD[msg.sender] -= NTDToTransfer; usersWithdrew[msg.sender] -= WithdrewToTransfer; usersNTD[targetAddress] += NTDToTransfer; usersWithdrew[targetAddress] += WithdrewToTransfer; } function ContractBalance () constant returns (uint) { return this.Ox77a1b3047fa5869cdcbd9fe2ddb6df510631fe35; } function ContractTotalMined() constant returns (uint) { return this.Ox77a1b3047fa5869cdcbd9fe2ddb6df510631fe35 + totalWithdrew; } function MyTotalNTD () constant returns (uint) { return usersNTD[msg.sender]; } function MyTotalWithdrew () constant returns (uint) { return usersWithdrew[msg.sender]; } function () payable {}}